<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Nacosé…ç½®ä¸­å¿ƒ</title>
    <link href="/2021/07/27/nacos-config/"/>
    <url>/2021/07/27/nacos-config/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/Nacos-config#spring-cloud-alibaba-nacos-config">æ¦‚å¿µ</a></h1><p>Nacos æä¾›ç”¨äºå­˜å‚¨é…ç½®å’Œå…¶ä»–å…ƒæ•°æ®çš„ key/value å­˜å‚¨ï¼Œä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤–éƒ¨åŒ–é…ç½®æä¾›æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ”¯æŒã€‚ä½¿ç”¨ Spring Cloud Alibaba Nacos Configï¼Œæ‚¨å¯ä»¥åœ¨ Nacos Server é›†ä¸­ç®¡ç†ä½  Spring Cloud åº”ç”¨çš„å¤–éƒ¨å±æ€§é…ç½®ã€‚</p><p>Spring Cloud Alibaba Nacos Config æ˜¯ Config Server å’Œ Client çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šçš„æ¦‚å¿µä¸ Spring Environment å’Œ PropertySource æœ‰ç€ä¸€è‡´çš„æŠ½è±¡ï¼Œåœ¨ç‰¹æ®Šçš„ bootstrap é˜¶æ®µï¼Œé…ç½®è¢«åŠ è½½åˆ° Spring ç¯å¢ƒä¸­ã€‚å½“åº”ç”¨ç¨‹åºé€šè¿‡éƒ¨ç½²ç®¡é“ä»å¼€å‘åˆ°æµ‹è¯•å†åˆ°ç”Ÿäº§æ—¶ï¼Œæ‚¨å¯ä»¥ç®¡ç†è¿™äº›ç¯å¢ƒä¹‹é—´çš„é…ç½®ï¼Œå¹¶ç¡®ä¿åº”ç”¨ç¨‹åºå…·æœ‰è¿ç§»æ—¶éœ€è¦è¿è¡Œçš„æ‰€æœ‰å†…å®¹ã€‚</p><h1 id="å¿«é€Ÿå¼€å§‹"><a href="#å¿«é€Ÿå¼€å§‹" class="headerlink" title="å¿«é€Ÿå¼€å§‹"></a>å¿«é€Ÿå¼€å§‹</h1><h2 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;spring.cloud.alibaba.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><p>åˆ›å»º <code>bootstrap.yaml</code>é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  Nacos Config ç›¸å…³é…ç½®ã€‚é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">demo-application</span><br><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-comment"># Nacos Config é…ç½®é¡¹ï¼Œå¯¹åº” NacosConfigProperties é…ç½®å±æ€§ç±»</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span> <span class="hljs-comment"># Nacos æœåŠ¡å™¨åœ°å€</span><br>        <span class="hljs-attr">namespace:</span> <span class="hljs-comment"># ä½¿ç”¨çš„ Nacos çš„å‘½åç©ºé—´ï¼Œé»˜è®¤ä¸º null</span><br>        <span class="hljs-attr">group:</span> <span class="hljs-string">DEFAULT_GROUP</span> <span class="hljs-comment"># ä½¿ç”¨çš„ Nacos é…ç½®åˆ†ç»„ï¼Œé»˜è®¤ä¸º DEFAULT_GROUP</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-comment"># ä½¿ç”¨çš„ Nacos é…ç½®é›†çš„ dataIdï¼Œé»˜è®¤ä¸º spring.application.name</span><br>        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">yaml</span> <span class="hljs-comment"># ä½¿ç”¨çš„ Nacos é…ç½®é›†çš„ dataId çš„æ–‡ä»¶æ‹“å±•åï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Nacos é…ç½®é›†çš„é…ç½®æ ¼å¼ï¼Œé»˜è®¤ä¸º properties</span><br><br></code></pre></td></tr></table></figure><p>Nacos Config é…ç½®é¡¹ï¼Œä»¥ <code>spring.cloud.nacos.config</code> å¼€å¤´ï¼Œå¯¹åº” <a href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-nacos-config/src/main/java/com/alibaba/cloud/nacos/NacosConfigProperties.java">NacosConfigProperties</a> é…ç½®å±æ€§ç±»ã€‚</p><ol><li><p><code>server-addr</code> é…ç½®é¡¹ï¼Œè®¾ç½® Nacos æœåŠ¡å™¨åœ°å€ã€‚</p></li><li><p><code>namespace</code> é…ç½®é¡¹ï¼Œä½¿ç”¨çš„ Nacos çš„å‘½åç©ºé—´ï¼Œé»˜è®¤ä¸º <code>null</code>ï¼Œè¡¨ç¤ºä½¿ç”¨ <code>public</code> è¿™ä¸ªé»˜è®¤å‘½åç©ºé—´ã€‚</p></li></ol><blockquote><p>FROM <a href="https://nacos.io/zh-cn/docs/concepts.html">ã€ŠNacos æ–‡æ¡£ â€”â€” Nacos æ¦‚å¿µã€‹</a></p><p><strong>å‘½åç©ºé—´</strong><br>ç”¨äºè¿›è¡Œç§Ÿæˆ·ç²’åº¦çš„é…ç½®éš”ç¦»ã€‚ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œå¯ä»¥å­˜åœ¨ç›¸åŒçš„ Group æˆ– Data ID çš„é…ç½®ã€‚Namespace çš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯ä¸åŒç¯å¢ƒçš„é…ç½®çš„åŒºåˆ†éš”ç¦»ï¼Œä¾‹å¦‚å¼€å‘æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„èµ„æºï¼ˆå¦‚é…ç½®ã€æœåŠ¡ï¼‰éš”ç¦»ç­‰ã€‚</p></blockquote><ol start="3"><li><code>group</code> é…ç½®é¡¹ï¼Œä½¿ç”¨çš„ Nacos é…ç½®åˆ†ç»„ï¼Œé»˜è®¤ä¸º <code>DEFAULT_GROUP</code>ã€‚</li></ol><blockquote><p>FROM <a href="https://nacos.io/zh-cn/docs/concepts.html">ã€ŠNacos æ–‡æ¡£ â€”â€” Nacos æ¦‚å¿µã€‹</a></p><p><strong>é…ç½®åˆ†ç»„</strong><br>Nacos ä¸­çš„ä¸€ç»„é…ç½®é›†ï¼Œæ˜¯ç»„ç»‡é…ç½®çš„ç»´åº¦ä¹‹ä¸€ã€‚é€šè¿‡ä¸€ä¸ªæœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ Buy æˆ– Trade ï¼‰å¯¹é…ç½®é›†è¿›è¡Œåˆ†ç»„ï¼Œä»è€ŒåŒºåˆ† Data ID ç›¸åŒçš„é…ç½®é›†ã€‚å½“æ‚¨åœ¨ Nacos ä¸Šåˆ›å»ºä¸€ä¸ªé…ç½®æ—¶ï¼Œå¦‚æœæœªå¡«å†™é…ç½®åˆ†ç»„çš„åç§°ï¼Œåˆ™é…ç½®åˆ†ç»„çš„åç§°é»˜è®¤é‡‡ç”¨ <code>DEFAULT_GROUP</code> ã€‚é…ç½®åˆ†ç»„çš„å¸¸è§åœºæ™¯ï¼šä¸åŒçš„åº”ç”¨æˆ–ç»„ä»¶ä½¿ç”¨äº†ç›¸åŒçš„é…ç½®ç±»å‹ï¼Œå¦‚ <code>database_url</code> é…ç½®å’Œ <code>MQ_topic</code> é…ç½®ã€‚</p></blockquote><ol start="4"><li><code>name</code> é…ç½®é¡¹ï¼Œä½¿ç”¨çš„ Nacos é…ç½®é›†çš„ dataIdï¼Œé»˜è®¤ä¸º <code>spring.application.name</code>ã€‚</li></ol><blockquote><p>FROM <a href="https://nacos.io/zh-cn/docs/concepts.html">ã€ŠNacos æ–‡æ¡£ â€”â€” Nacos æ¦‚å¿µã€‹</a></p><p><strong>é…ç½®é›†</strong><br>ä¸€ç»„ç›¸å…³æˆ–è€…ä¸ç›¸å…³çš„é…ç½®é¡¹çš„é›†åˆç§°ä¸ºé…ç½®é›†ã€‚åœ¨ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶é€šå¸¸å°±æ˜¯ä¸€ä¸ªé…ç½®é›†ï¼ŒåŒ…å«äº†ç³»ç»Ÿå„ä¸ªæ–¹é¢çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªé…ç½®é›†å¯èƒ½åŒ…å«äº†æ•°æ®æºã€çº¿ç¨‹æ± ã€æ—¥å¿—çº§åˆ«ç­‰é…ç½®é¡¹ã€‚</p><p><strong>é…ç½®é›† ID</strong><br>Nacos ä¸­çš„æŸä¸ªé…ç½®é›†çš„ IDã€‚é…ç½®é›† ID æ˜¯ç»„ç»‡åˆ’åˆ†é…ç½®çš„ç»´åº¦ä¹‹ä¸€ã€‚Data ID é€šå¸¸ç”¨äºç»„ç»‡åˆ’åˆ†ç³»ç»Ÿçš„é…ç½®é›†ã€‚ä¸€ä¸ªç³»ç»Ÿæˆ–è€…åº”ç”¨å¯ä»¥åŒ…å«å¤šä¸ªé…ç½®é›†ï¼Œæ¯ä¸ªé…ç½®é›†éƒ½å¯ä»¥è¢«ä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°æ ‡è¯†ã€‚Data ID é€šå¸¸é‡‡ç”¨ç±» Java åŒ…ï¼ˆå¦‚ <code>com.taobao.tc.refund.log.level</code>ï¼‰çš„å‘½åè§„åˆ™ä¿è¯å…¨å±€å”¯ä¸€æ€§ã€‚æ­¤å‘½åè§„åˆ™éå¼ºåˆ¶ã€‚</p></blockquote><p>å› ä¸ºè¿™é‡Œæˆ‘ä»¬æœªè¿›è¡Œé…ç½®ï¼Œæ‰€ä»¥ä½¿ç”¨ Nacos é…ç½®é›†çš„ dataId ä¸º <code>demo-application</code>ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å°† <code>spring.application.name</code> é…ç½®é¡¹æ·»åŠ åˆ° <code>bootstrap.yaml</code> é…ç½®æ–‡ä»¶ä¸­çš„åŸå› ã€‚</p><ol start="5"><li><code>file-extension</code> é…ç½®é¡¹ï¼Œä½¿ç”¨çš„ Nacos é…ç½®é›†çš„ dataId çš„<strong>æ–‡ä»¶æ‹“å±•å</strong>ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Nacos é…ç½®é›†çš„<strong>é…ç½®æ ¼å¼</strong>ï¼Œé»˜è®¤ä¸º <code>properties</code>ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸º <code>yaml</code>ï¼Œå› ä¸ºæˆ‘ä»¬ç¨åä½¿ç”¨çš„é…ç½®é›†çš„é…ç½®æ ¼å¼ä¸º <code>YAML</code>ã€‚</li></ol><h3 id="bootstrap-yaml"><a href="#bootstrap-yaml" class="headerlink" title="bootstrap.yaml"></a>bootstrap.yaml</h3><blockquote><p>ä¸ºä»€ä¹ˆè¦å°† Nacos Config çš„é…ç½®é¡¹æ·»åŠ åˆ° <code>bootstrap.yaml</code> é…ç½®æ–‡ä»¶ï¼Œè€Œä¸åƒæˆ‘ä»¬ä¹‹å‰çš„ä¸€æ ·ï¼Œæ·»åŠ åˆ° <code>application.yaml</code> é…ç½®æ–‡ä»¶ä¸­å‘¢ï¼Ÿ</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥è®²è§£ä¸‹åŸå› </p></blockquote><p>åœ¨ Spring Cloud åº”ç”¨ä¸­ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ª <strong>Bootstrap</strong> Contextï¼ˆ<strong>å¼•å¯¼</strong>ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ¯” Spring Boot åˆ›å»º <strong>Application</strong> Contextï¼ˆ<strong>åº”ç”¨</strong>ä¸Šä¸‹æ–‡ï¼‰<strong>æ›´æ—©åˆå§‹åŒ–</strong>ã€‚</p><p>Bootstrap Context æ–°å¢äº†ä¸€ä¸ª <code>bootstrap.yaml</code> <strong>é…ç½®æ–‡ä»¶</strong>ï¼Œä¿è¯å’Œ Application Context çš„ <code>application.yaml</code> <strong>é…ç½®æ–‡ä»¶</strong>çš„<strong>éš”ç¦»</strong>ã€‚</p><p>æœ‰äº†é…ç½®æ–‡ä»¶çš„éš”ç¦»ä¹‹åï¼ŒBootstrap Context åˆå§‹åŒ–çš„ <strong>Bean</strong> ä»å“ªé‡Œæ¥ï¼ŸSpring Cloud æ–°å®šä¹‰äº†ä¸“å±äº Bootstrap Context çš„è‡ªåŠ¨åŒ–é…ç½®ç±»çš„æ‹“å±•ç‚¹ <strong>BootstrapConfiguration</strong>ï¼Œå’Œ Spring Boot ä¸º Application Context çš„è‡ªåŠ¨åŒ–é…ç½®ç±»çš„æ‹“å±•ç‚¹ <strong>EnableAutoConfiguration</strong>çš„<strong>éš”ç¦»</strong>ï¼Œä¿è¯ä¸¤ä¸ª Context åˆ›å»ºå„è‡ªçš„ Beanã€‚</p><p>è™½ç„¶è¯´ï¼ŒBootstrap Context å’Œ Application Context åšäº†è¿™ä¹ˆå¤šéš”ç¦»ï¼Œä½†æ˜¯å®ƒä»¬æœ‰ä¸€ç‚¹æ˜¯å…±äº«çš„ï¼Œé‚£å°±æ˜¯ <strong>Environment</strong>ã€‚åœ¨ Spring ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ Environment è·å–å±æ€§é…ç½®ï¼Œä¾‹å¦‚è¯´ <code>spring.application.name</code> å¯¹åº”çš„å€¼æ˜¯å¤šå°‘ã€‚</p><p>äº†è§£å®Œè¿™äº›ä¹‹åï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬ä¸²è”åœ¨ä¸€èµ·å»æ€è€ƒä¸€ä¸‹ï¼ŒBootstrap Context çš„<strong>ç›®çš„</strong>ç©¶ç«Ÿæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿé€šè¿‡ Bootstrap Context çš„ä¼˜å…ˆåˆå§‹åŒ–ï¼Œ<strong>å°†é…ç½®åŠ è½½åˆ° Environment ä¸­</strong>ï¼Œæä¾›ç»™åé¢çš„ Application Context ä½¿ç”¨ã€‚</p><p>ä¸¾ä¸ªè´¼é‡è¦çš„ä¾‹å­ï¼Œç¨åæˆ‘ä»¬ä¼šåœ¨ <code>bootstrap.yaml</code> æ·»åŠ  Spring Cloud Alibaba Nacos Config ç›¸å…³çš„é…ç½®ï¼Œè¿™æ · Bootstrap Context åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡ NacosConfigBootstrapConfiguration åˆ›å»º Nacos ç›¸å…³çš„ Beanï¼Œç„¶åå®ç°ä» Nacos é…ç½®ä¸­å¿ƒåŠ è½½é…ç½®åˆ° Environment ä¸­ã€‚</p><p>å¦‚æœæˆ‘ä»¬æŠŠ Spring Cloud Alibaba Nacos Config ç›¸å…³çš„é…ç½®æ·»åŠ åœ¨ <code>application.yaml</code> ä¸­ï¼Œé‚£ä¹ˆå¯èƒ½æ— æ³•ä¿è¯ Nacos ç›¸å…³çš„ Bean è¢«<strong>æœ€å…ˆ</strong>åˆå§‹åŒ–ï¼Œå®Œæˆä» Nacos è·å–é…ç½®ï¼Œä»è€Œå½±å“åˆ›å»ºçš„ Beanã€‚</p><h2 id="åˆ›å»º-Nacos-é…ç½®é›†"><a href="#åˆ›å»º-Nacos-é…ç½®é›†" class="headerlink" title="åˆ›å»º Nacos é…ç½®é›†"></a>åˆ›å»º Nacos é…ç½®é›†</h2><p>æ‰“å¼€ Nacos UI ç•Œé¢çš„ã€Œé…ç½®åˆ—è¡¨ã€èœå•ï¼Œè¿›å…¥ã€Œé…ç½®ç®¡ç†ã€åŠŸèƒ½ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/images/nacos/nacos-config-save.png"></p><h2 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h2><p>åˆ›å»º OrderPropertiesé…ç½®ç±»ï¼Œè¯»å– <code>order</code> é…ç½®é¡¹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;order&quot;)</span><br><span class="hljs-comment">// @NacosConfigurationProperties(prefix = &quot;order&quot;, dataId = &quot;$&#123;nacos.config.data-id&#125;&quot;, type = ConfigType.YAML)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderProperties</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¢å•æ”¯ä»˜è¶…æ—¶æ—¶é•¿ï¼Œå•ä½ï¼šç§’ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Integer payTimeoutSeconds;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¢å•åˆ›å»ºé¢‘ç‡ï¼Œå•ä½ï¼šç§’</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Integer createFrequencySeconds;<br><br>    <span class="hljs-comment">// ... çœç•¥ setter/getter æ–¹æ³•</span><br><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>åœ¨ç±»ä¸Šï¼Œæ·»åŠ  <code>@Component</code> æ³¨è§£ï¼Œä¿è¯è¯¥é…ç½®ç±»å¯ä»¥ä½œä¸ºä¸€ä¸ª Bean è¢«æ‰«æåˆ°ã€‚</li><li>åœ¨ç±»ä¸Šï¼Œæ·»åŠ  <code>@ConfigurationProperties</code> æ³¨è§£ï¼Œå¹¶è®¾ç½® <code>prefix = &quot;order&quot;</code> å±æ€§ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥è¯»å–<strong>å‰ç¼€</strong>ä¸º <code>order</code> é…ç½®é¡¹ï¼Œè®¾ç½®åˆ°é…ç½®ç±»å¯¹åº”çš„å±æ€§ä¸Šã€‚</li></ul><p>åˆ›å»º DemoControllerç±»ï¼Œæä¾›æµ‹è¯• <code>@ConfigurationProperties</code> å’Œ <code>@Value</code> æ³¨å…¥é…ç½®çš„ä¸¤ä¸ª HTTP æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/demo&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> OrderProperties orderProperties;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æµ‹è¯• <span class="hljs-doctag">@ConfigurationProperties</span> æ³¨è§£çš„é…ç½®å±æ€§ç±»</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;/test01&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> OrderProperties <span class="hljs-title">test01</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> orderProperties;<br>    &#125;<br><br>    <span class="hljs-meta">@Value(value = &quot;$&#123;order.pay-timeout-seconds&#125;&quot;)</span> <span class="hljs-comment">// @NacosValue(value = &quot;$&#123;order.pay-timeout-seconds&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer payTimeoutSeconds;<br>    <span class="hljs-meta">@Value(value = &quot;$&#123;order.create-frequency-seconds&#125;&quot;)</span> <span class="hljs-comment">// @NacosValue(value = &quot;$&#123;order.create-frequency-seconds&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer createFrequencySeconds;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æµ‹è¯• <span class="hljs-doctag">@Value</span> æ³¨è§£çš„å±æ€§</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;/test02&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title">test02</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JSONObject().fluentPut(<span class="hljs-string">&quot;payTimeoutSeconds&quot;</span>, payTimeoutSeconds)<br>                .fluentPut(<span class="hljs-string">&quot;createFrequencySeconds&quot;</span>, createFrequencySeconds);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç®€å•æµ‹è¯•"><a href="#ç®€å•æµ‹è¯•" class="headerlink" title="ç®€å•æµ‹è¯•"></a>ç®€å•æµ‹è¯•</h2><p>è®¿é—® <a href="http://127.0.0.1:8080/demo/test01">http://127.0.0.1:8080/demo/test01</a> æ¥å£</p><p>è®¿é—® <a href="http://127.0.0.1:8080/demo/test02">http://127.0.0.1:8080/demo/test02</a> æ¥å£</p><p>ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;payTimeoutSeconds&quot;</span>: <span class="hljs-number">60</span>,<br>    <span class="hljs-attr">&quot;createFrequencySeconds&quot;</span>: <span class="hljs-number">120</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="è‡ªåŠ¨åˆ·æ–°é…ç½®"><a href="#è‡ªåŠ¨åˆ·æ–°é…ç½®" class="headerlink" title="è‡ªåŠ¨åˆ·æ–°é…ç½®"></a>è‡ªåŠ¨åˆ·æ–°é…ç½®</h1><ul><li>ä½¿ç”¨ <code>@ConfigurationProperties</code> æ³¨è§£ï¼Œä½¿ç”¨ <code>@Value</code> æ³¨è§£çš„<strong>ä¸ä¼š</strong></li><li>ä½¿ç”¨ <code>@RefreshScope</code> æ³¨è§£ï¼Œ</li></ul><h2 id="EnvironmentChangeEvent"><a href="#EnvironmentChangeEvent" class="headerlink" title="EnvironmentChangeEvent"></a>EnvironmentChangeEvent</h2><p>é€šè¿‡ <code>@ConfigurationProperties</code> æˆ–è€… <code>@Value</code> + <code>@RefreshScope</code> æ³¨è§£ï¼Œå·²ç»èƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬ç»å¤§å¤šæ•°åœºæ™¯ä¸‹çš„è‡ªåŠ¨åˆ·æ–°é…ç½®çš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦<strong>å®ç°å¯¹é…ç½®çš„ç›‘å¬ï¼Œæ‰§è¡Œè‡ªå®šä¹‰çš„é€»è¾‘</strong>ã€‚</p><p>ä¾‹å¦‚è¯´ï¼Œå½“æ•°æ®åº“è¿æ¥çš„é…ç½®å‘ç”Ÿå˜æ›´æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ç›‘å¬è¯¥é…ç½®çš„å˜æ›´ï¼Œé‡æ–°åˆå§‹åŒ–åº”ç”¨ä¸­çš„æ•°æ®åº“è¿æ¥ï¼Œä»è€Œè®¿é—®åˆ°æ–°çš„æ•°æ®åº“åœ°å€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoEnvironmentChangeListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationListener</span>&lt;<span class="hljs-title">EnvironmentChangeEvent</span>&gt; </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Logger logger = LoggerFactory.getLogger(getClass());<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ConfigurableEnvironment environment;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onApplicationEvent</span><span class="hljs-params">(EnvironmentChangeEvent event)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (String key : event.getKeys()) &#123;<br>            logger.info(<span class="hljs-string">&quot;[onApplicationEvent][key(&#123;&#125;) æœ€æ–° value ä¸º &#123;&#125;]&quot;</span>, key, environment.getProperty(key));<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h1><ul><li><a href="https://nacos.io/zh-cn/docs/what-is-nacos.html">ã€ŠNacos å®˜æ–¹æ–‡æ¡£ã€‹</a></li><li><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/Nacos-config">ã€ŠSpring Cloud Alibaba å®˜æ–¹<strong>æ–‡æ¡£</strong> â€”â€” Nacos Configã€‹</a></li><li><a href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-examples/nacos-example/nacos-config-example/readme-zh.md">ã€ŠSpring Cloud Alibaba å®˜æ–¹<strong>ç¤ºä¾‹</strong> â€”â€” Nacos Configã€‹</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Nacos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nacosæ•°æ®æ¨¡å‹</title>
    <link href="/2021/07/27/nacos-data-model/"/>
    <url>/2021/07/27/nacos-data-model/</url>
    
    <content type="html"><![CDATA[<h2 id="æ•°æ®æ¨¡å‹"><a href="#æ•°æ®æ¨¡å‹" class="headerlink" title="æ•°æ®æ¨¡å‹"></a>æ•°æ®æ¨¡å‹</h2><p>Nacos æ•°æ®æ¨¡å‹ Key ç”±ä¸‰å…ƒç»„å”¯ä¸€ç¡®è®¤ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/images/nacos/nacos-data-model.jpeg" alt="ç‚¹å‡»"></p><ul><li>ä½œä¸ºæ³¨å†Œä¸­å¿ƒæ—¶ï¼ŒNamespace + Group + Service</li><li>ä½œä¸ºé…ç½®ä¸­å¿ƒæ—¶ï¼ŒNamespace + Group + DataId</li></ul><h2 id="Namespace-å‘½åç©ºé—´"><a href="#Namespace-å‘½åç©ºé—´" class="headerlink" title="Namespace å‘½åç©ºé—´"></a>Namespace å‘½åç©ºé—´</h2><p>ç”¨äºè¿›è¡Œç§Ÿæˆ·ç²’åº¦çš„é…ç½®éš”ç¦»ã€‚é»˜è®¤ä¸º publicï¼ˆå…¬å…±å‘½åç©ºé—´ï¼‰ã€‚</p><p>ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œå¯ä»¥å­˜åœ¨ç›¸åŒçš„ Group æˆ– Data ID çš„é…ç½®ã€‚Namespace çš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯ä¸åŒç¯å¢ƒçš„é…ç½®çš„åŒºåˆ†éš”ç¦»ï¼Œä¾‹å¦‚å¼€å‘æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„èµ„æºï¼ˆå¦‚é…ç½®ã€æœåŠ¡ï¼‰éš”ç¦»ç­‰ã€‚</p><h2 id="Group-æœåŠ¡åˆ†ç»„"><a href="#Group-æœåŠ¡åˆ†ç»„" class="headerlink" title="Group æœåŠ¡åˆ†ç»„"></a>Group æœåŠ¡åˆ†ç»„</h2><p>ä¸åŒçš„æœåŠ¡å¯ä»¥å½’ç±»åˆ°åŒä¸€åˆ†ç»„ã€‚é»˜è®¤ä¸º DEFAULT_GROUPï¼ˆé»˜è®¤åˆ†ç»„ï¼‰ã€‚</p><h2 id="Service-æœåŠ¡"><a href="#Service-æœåŠ¡" class="headerlink" title="Service æœåŠ¡"></a>Service æœåŠ¡</h2><p>ä¾‹å¦‚è¯´ï¼Œç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ã€å•†å“æœåŠ¡ç­‰ç­‰ã€‚</p><h2 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h2><ul><li><a href="https://nacos.io/zh-cn/docs/what-is-nacos.html">ã€ŠNacos å®˜æ–¹æ–‡æ¡£ â€”â€” æ¦‚å¿µã€‹</a></li><li><a href="https://nacos.io/zh-cn/docs/architecture.html">ã€ŠNacos å®˜æ–¹æ–‡æ¡£ â€”â€” æ¶æ„ã€‹</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Nacos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nacosæ³¨å†Œä¸­å¿ƒ</title>
    <link href="/2021/07/27/nacos-discovery/"/>
    <url>/2021/07/27/nacos-discovery/</url>
    
    <content type="html"><![CDATA[<h3 id="æœåŠ¡å‘ç°å’ŒæœåŠ¡å¥åº·ç›‘æµ‹"><a href="#æœåŠ¡å‘ç°å’ŒæœåŠ¡å¥åº·ç›‘æµ‹" class="headerlink" title="æœåŠ¡å‘ç°å’ŒæœåŠ¡å¥åº·ç›‘æµ‹"></a><strong>æœåŠ¡å‘ç°å’ŒæœåŠ¡å¥åº·ç›‘æµ‹</strong></h3><p>Nacos æ”¯æŒåŸºäº DNS å’ŒåŸºäº RPC çš„æœåŠ¡å‘ç°ã€‚æœåŠ¡æä¾›è€…ä½¿ç”¨ <a href="https://nacos.io/zh-cn/docs/sdk.html">åŸç”ŸSDK</a>ã€<a href="https://nacos.io/zh-cn/docs/open-api.html">OpenAPI</a>ã€æˆ–ä¸€ä¸ª<a href="https://nacos.io/zh-cn/docs/other-language.html">ç‹¬ç«‹çš„Agent TODO</a>æ³¨å†Œ Service åï¼ŒæœåŠ¡æ¶ˆè´¹è€…å¯ä»¥ä½¿ç”¨<a href="https://nacos.io/zh-cn/docs/xx">DNS TODO</a> æˆ–<a href="https://nacos.io/zh-cn/docs/open-api.html">HTTP&amp;API</a>æŸ¥æ‰¾å’Œå‘ç°æœåŠ¡ã€‚</p><p>Nacos æä¾›å¯¹æœåŠ¡çš„å®æ—¶çš„å¥åº·æ£€æŸ¥ï¼Œé˜»æ­¢å‘ä¸å¥åº·çš„ä¸»æœºæˆ–æœåŠ¡å®ä¾‹å‘é€è¯·æ±‚ã€‚Nacos æ”¯æŒä¼ è¾“å±‚ (PING æˆ– TCP)å’Œåº”ç”¨å±‚ (å¦‚ HTTPã€MySQLã€ç”¨æˆ·è‡ªå®šä¹‰ï¼‰çš„å¥åº·æ£€æŸ¥ã€‚ å¯¹äºå¤æ‚çš„äº‘ç¯å¢ƒå’Œç½‘ç»œæ‹“æ‰‘ç¯å¢ƒä¸­ï¼ˆå¦‚ VPCã€è¾¹ç¼˜ç½‘ç»œç­‰ï¼‰æœåŠ¡çš„å¥åº·æ£€æŸ¥ï¼ŒNacos æä¾›äº† agent ä¸ŠæŠ¥æ¨¡å¼å’ŒæœåŠ¡ç«¯ä¸»åŠ¨æ£€æµ‹2ç§å¥åº·æ£€æŸ¥æ¨¡å¼ã€‚Nacos è¿˜æä¾›äº†ç»Ÿä¸€çš„å¥åº·æ£€æŸ¥ä»ªè¡¨ç›˜ï¼Œå¸®åŠ©æ‚¨æ ¹æ®å¥åº·çŠ¶æ€ç®¡ç†æœåŠ¡çš„å¯ç”¨æ€§åŠæµé‡ã€‚</p><h3 id="æ³¨å†Œä¸­å¿ƒåŸç†"><a href="#æ³¨å†Œä¸­å¿ƒåŸç†" class="headerlink" title="æ³¨å†Œä¸­å¿ƒåŸç†"></a>æ³¨å†Œä¸­å¿ƒåŸç†</h3><p>åœ¨ä½¿ç”¨æ³¨å†Œä¸­å¿ƒæ—¶ï¼Œä¸€å…±æœ‰ä¸‰ç§è§’è‰²ï¼šæœåŠ¡æä¾›è€…ï¼ˆService Providerï¼‰ã€æœåŠ¡æ¶ˆè´¹è€…ï¼ˆService Consumerï¼‰ã€æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰ã€‚</p><p><img src="/images/nacos/nacos-dis.png" alt="ç‚¹å‡»"></p><ol><li>Providerï¼š</li></ol><ul><li>å¯åŠ¨æ—¶ï¼Œå‘ Registry <strong>æ³¨å†Œ</strong>è‡ªå·±ä¸ºä¸€ä¸ªæœåŠ¡ï¼ˆServiceï¼‰çš„å®ä¾‹ï¼ˆInstanceï¼‰ã€‚</li><li>åŒæ—¶ï¼Œå®šæœŸå‘ Registry å‘é€<strong>å¿ƒè·³</strong>ï¼Œå‘Šè¯‰è‡ªå·±è¿˜å­˜æ´»ã€‚</li><li>å…³é—­æ—¶ï¼Œå‘ Registry <strong>å–æ¶ˆæ³¨å†Œ</strong>ã€‚</li></ul><ol start="2"><li>Consumerï¼š</li></ol><ul><li>å¯åŠ¨æ—¶ï¼Œå‘ Registry <strong>è®¢é˜…</strong>ä½¿ç”¨åˆ°çš„æœåŠ¡ï¼Œå¹¶ç¼“å­˜æœåŠ¡çš„å®ä¾‹åˆ—è¡¨åœ¨å†…å­˜ä¸­ã€‚</li><li>åç»­ï¼ŒConsumer å‘å¯¹åº”æœåŠ¡çš„ Provider å‘èµ·<strong>è°ƒç”¨</strong>æ—¶ï¼Œä»å†…å­˜ä¸­çš„è¯¥æœåŠ¡çš„å®ä¾‹åˆ—è¡¨é€‰æ‹©ä¸€ä¸ªï¼Œè¿›è¡Œè¿œç¨‹è°ƒç”¨ã€‚</li><li>å…³é—­æ—¶ï¼Œå‘ Registry <strong>å–æ¶ˆè®¢é˜…</strong>ã€‚</li></ul><ol start="3"><li>Registryï¼š</li></ol><ul><li>Provider è¶…è¿‡ä¸€å®šæ—¶é—´æœª<strong>å¿ƒè·³</strong>æ—¶ï¼Œä»æœåŠ¡çš„å®ä¾‹åˆ—è¡¨ç§»é™¤ã€‚</li><li>æœåŠ¡çš„å®ä¾‹åˆ—è¡¨å‘ç”Ÿå˜åŒ–ï¼ˆæ–°å¢æˆ–è€…ç§»é™¤ï¼‰æ—¶ï¼Œé€šçŸ¥è®¢é˜…è¯¥æœåŠ¡çš„ Consumerï¼Œä»è€Œè®© Consumer èƒ½å¤Ÿåˆ·æ–°æœ¬åœ°ç¼“å­˜ã€‚</li></ul><p>å½“ç„¶ï¼Œä¸åŒçš„æ³¨å†Œä¸­å¿ƒå¯èƒ½åœ¨å®ç°åŸç†ä¸Šä¼šç•¥æœ‰å·®å¼‚ã€‚ä¾‹å¦‚è¯´ï¼Œ<a href="https://github.com/Netflix/eureka/">Eureka</a> æ³¨å†Œä¸­å¿ƒï¼Œå¹¶ä¸æä¾›é€šçŸ¥åŠŸèƒ½ï¼Œè€Œæ˜¯ Eureka Client è‡ªå·±å®šæœŸè½®è¯¢ï¼Œå®ç°æœ¬åœ°ç¼“å­˜çš„æ›´æ–°ã€‚</p><p>å¦å¤–ï¼ŒProvider å’Œ Consumer æ˜¯è§’è‰²ä¸Šçš„å®šä¹‰ï¼Œä¸€ä¸ªæœåŠ¡<strong>åŒæ—¶</strong>å³å¯ä»¥æ˜¯ Provider ä¹Ÿå¯ä»¥ä½œä¸º Consumerã€‚ä¾‹å¦‚è¯´ï¼Œä¼˜æƒ åŠµæœåŠ¡å¯ä»¥ç»™è®¢å•æœåŠ¡æä¾›æ¥å£ï¼ŒåŒæ—¶åˆè°ƒç”¨ç”¨æˆ·æœåŠ¡æä¾›çš„æ¥å£ã€‚</p><h3 id="å¿«é€Ÿå¼€å§‹"><a href="#å¿«é€Ÿå¼€å§‹" class="headerlink" title="å¿«é€Ÿå¼€å§‹"></a>å¿«é€Ÿå¼€å§‹</h3><h4 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;spring.cloud.alibaba.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="ç”Ÿäº§è€…"><a href="#ç”Ÿäº§è€…" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><p>é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">demo-provider</span> <span class="hljs-comment"># Spring åº”ç”¨å</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-comment"># Nacos ä½œä¸ºæ³¨å†Œä¸­å¿ƒçš„é…ç½®é¡¹ï¼Œå¯¹åº” NacosDiscoveryProperties é…ç½®ç±»</span><br>      <span class="hljs-attr">discovery:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span> <span class="hljs-comment"># Nacos æœåŠ¡å™¨åœ°å€</span><br>        <span class="hljs-attr">service:</span> <span class="hljs-string">$&#123;spring.application.name&#125;</span> <span class="hljs-comment"># æ³¨å†Œåˆ° Nacos çš„æœåŠ¡åã€‚é»˜è®¤å€¼ä¸º $&#123;spring.application.name&#125;ã€‚</span><br><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">18080</span> <span class="hljs-comment"># æœåŠ¡å™¨ç«¯å£ã€‚é»˜è®¤ä¸º 8080</span><br></code></pre></td></tr></table></figure><p>é‡ç‚¹çœ‹ <code>spring.cloud.nacos.discovery</code> é…ç½®é¡¹ï¼Œå®ƒæ˜¯ Nacos Discovery é…ç½®é¡¹çš„å‰ç¼€ï¼Œå¯¹åº” <a href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-nacos-discovery/src/main/java/com/alibaba/cloud/nacos/NacosDiscoveryProperties.java">NacosDiscoveryProperties</a> é…ç½®é¡¹ã€‚</p><p>åˆ›å»º DemoProviderApplication ç±»ï¼Œåˆ›å»ºåº”ç”¨å¯åŠ¨ç±»ï¼Œå¹¶æä¾› HTTP æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoProviderApplication</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(DemoProviderApplication.class, args);<br>    &#125;<br><br>    <span class="hljs-meta">@RestController</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span> </span>&#123;<br><br>        <span class="hljs-meta">@GetMapping(&quot;/echo&quot;)</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">echo</span><span class="hljs-params">(String name)</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;provider:&quot;</span> + name;<br>        &#125;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><ol><li><p><code>@SpringBootApplication</code> æ³¨è§£ï¼Œè¢«æ·»åŠ åœ¨ç±»ä¸Šï¼Œå£°æ˜è¿™æ˜¯ä¸€ä¸ª Spring Boot åº”ç”¨ã€‚Spring Cloud æ˜¯æ„å»ºåœ¨ Spring Boot ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ ã€‚</p></li><li><p><a href="https://github.com/spring-cloud/spring-cloud-commons/blob/master/spring-cloud-commons/src/main/java/org/springframework/cloud/client/discovery/EnableDiscoveryClient.java"><code>@EnableDiscoveryClient</code></a> æ³¨è§£ï¼Œå¼€å¯ Spring Cloud çš„æ³¨å†Œå‘ç°åŠŸèƒ½ã€‚ä¸è¿‡ä» Spring Cloud Edgware ç‰ˆæœ¬å¼€å§‹ï¼Œå®é™…ä¸Šå·²ç»ä¸éœ€è¦æ·»åŠ  <code>@EnableDiscoveryClient</code> æ³¨è§£ï¼Œåªéœ€è¦å¼•å…¥ Spring Cloud æ³¨å†Œå‘ç°ç»„ä»¶ï¼Œå°±ä¼šè‡ªåŠ¨å¼€å¯æ³¨å†Œå‘ç°çš„åŠŸèƒ½ã€‚ä¾‹å¦‚è¯´ï¼Œæˆ‘ä»¬è¿™é‡Œå·²ç»å¼•å…¥äº† <code>spring-cloud-starter-alibaba-nacos-discovery</code> ä¾èµ–ï¼Œå°±ä¸ç”¨å†æ·»åŠ  <code>@EnableDiscoveryClient</code> æ³¨è§£äº†ã€‚</p></li></ol><h4 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><p>é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">demo-provider</span> <span class="hljs-comment"># Spring åº”ç”¨å</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-comment"># Nacos ä½œä¸ºæ³¨å†Œä¸­å¿ƒçš„é…ç½®é¡¹ï¼Œå¯¹åº” NacosDiscoveryProperties é…ç½®ç±»</span><br>      <span class="hljs-attr">discovery:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span> <span class="hljs-comment"># Nacos æœåŠ¡å™¨åœ°å€</span><br>        <span class="hljs-attr">service:</span> <span class="hljs-string">$&#123;spring.application.name&#125;</span> <span class="hljs-comment"># æ³¨å†Œåˆ° Nacos çš„æœåŠ¡åã€‚é»˜è®¤å€¼ä¸º $&#123;spring.application.name&#125;ã€‚</span><br><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">28080</span> <span class="hljs-comment"># æœåŠ¡å™¨ç«¯å£ã€‚é»˜è®¤ä¸º 8080</span><br></code></pre></td></tr></table></figure><p>åˆ›å»º DemoConsumerApplicationç±»ï¼Œåˆ›å»ºåº”ç”¨å¯åŠ¨ç±»ï¼Œå¹¶æä¾›ä¸€ä¸ªè°ƒç”¨æœåŠ¡æä¾›è€…çš„ HTTP æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-comment">// @EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoConsumerApplication</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(DemoConsumerApplication.class, args);<br>    &#125;<br><br>    <span class="hljs-meta">@Configuration</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateConfiguration</span> </span>&#123;<br><br>        <span class="hljs-meta">@Bean</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> RestTemplate <span class="hljs-title">restTemplate</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RestTemplate();<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-meta">@RestController</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span> </span>&#123;<br><br>        <span class="hljs-meta">@Autowired</span><br>        <span class="hljs-keyword">private</span> DiscoveryClient discoveryClient;<br>        <span class="hljs-meta">@Autowired</span><br>        <span class="hljs-keyword">private</span> RestTemplate restTemplate;<br>        <span class="hljs-meta">@Autowired</span><br>        <span class="hljs-keyword">private</span> LoadBalancerClient loadBalancerClient;<br><br>        <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">(String name)</span> </span>&#123;<br>            <span class="hljs-comment">// &lt;1&gt; è·å¾—æœåŠ¡ `demo-provider` çš„ä¸€ä¸ªå®ä¾‹</span><br>            ServiceInstance instance;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">true</span>) &#123;<br>                <span class="hljs-comment">// è·å–æœåŠ¡ `demo-provider` å¯¹åº”çš„å®ä¾‹åˆ—è¡¨</span><br>                List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(<span class="hljs-string">&quot;demo-provider&quot;</span>);<br>                <span class="hljs-comment">// é€‰æ‹©ç¬¬ä¸€ä¸ª</span><br>                instance = instances.size() &gt; <span class="hljs-number">0</span> ? instances.get(<span class="hljs-number">0</span>) : <span class="hljs-keyword">null</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                instance = loadBalancerClient.choose(<span class="hljs-string">&quot;demo-provider&quot;</span>);<br>            &#125;<br>            <span class="hljs-comment">// &lt;2&gt; å‘èµ·è°ƒç”¨</span><br>            <span class="hljs-keyword">if</span> (instance == <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">&quot;è·å–ä¸åˆ°å®ä¾‹&quot;</span>);<br>            &#125;<br>            String targetUrl = instance.getUri() + <span class="hljs-string">&quot;/echo?name=&quot;</span> + name;<br>            String response = restTemplate.getForObject(targetUrl, String.class);<br>            <span class="hljs-comment">// è¿”å›ç»“æœ</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;consumer:&quot;</span> + response;<br>        &#125;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><ol><li><p><code>@EnableDiscoveryClient</code> æ³¨è§£ï¼Œå› ä¸ºå·²ç»æ— éœ€æ·»åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿›è¡Œäº†æ³¨é‡Šï¼ŒåŸå› åœ¨ä¸Šé¢å·²ç»è§£é‡Šè¿‡ã€‚</p></li><li><p>RestTemplateConfiguration é…ç½®ç±»ï¼Œåˆ›å»º <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-web/src/main/java/org/springframework/web/client/RestTemplate.java">RestTemplate</a> Beanã€‚RestTemplate æ˜¯ Spring æä¾›çš„ HTTP è°ƒç”¨æ¨¡æ¿å·¥å…·ç±»ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬ç¨åè°ƒç”¨æœåŠ¡æä¾›è€…çš„ HTTP APIã€‚</p></li><li><p>TestController æä¾›äº† <code>/hello</code> æ¥å£ï¼Œç”¨äºè°ƒç”¨æœåŠ¡æä¾›è€…çš„ <code>/demo</code> æ¥å£ã€‚ä»£ç ç•¥å¾®æœ‰å‡ è¡Œï¼Œæˆ‘ä»¬æ¥ç¨å¾®è§£é‡Šä¸‹å“ˆã€‚</p></li></ol><p><code>discoveryClient</code> å±æ€§ï¼ŒDiscoveryClient å¯¹è±¡ï¼ŒæœåŠ¡å‘ç°å®¢æˆ·ç«¯ï¼Œä¸Šæ–‡æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡ã€‚è¿™é‡Œæˆ‘ä»¬æ³¨å…¥çš„ä¸æ˜¯ Nacos Discovery æä¾›çš„ NacosDiscoveryClientï¼Œä¿è¯é€šç”¨æ€§ã€‚æœªæ¥å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨ Nacos ä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œè€Œæ˜¯ä½¿ç”¨ Eureka æˆ–åˆ™ Zookeeper æ—¶ï¼Œåˆ™æ— éœ€æ”¹åŠ¨è¿™é‡Œçš„ä»£ç ã€‚</p><p><code>loadBalancerClient</code> å±æ€§ï¼Œ<a href="https://github.com/spring-cloud/spring-cloud-commons/blob/master/spring-cloud-commons/src/main/java/org/springframework/cloud/client/loadbalancer/LoadBalancerClient.java">LoadBalancerClient</a> å¯¹è±¡ï¼Œè´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ã€‚ç¨åæˆ‘ä»¬ä¼šä½¿ç”¨å®ƒï¼Œä» Nacos è·å–çš„æœåŠ¡ <code>demo-provider</code> çš„å®ä¾‹åˆ—è¡¨ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªè¿›è¡Œ HTTP è°ƒç”¨ã€‚</p><blockquote><p>æ‹“å±•å°çŸ¥è¯†ï¼šåœ¨ Spring Cloud Common é¡¹ç›®ä¸­ï¼Œå®šä¹‰äº†<a href="https://github.com/spring-cloud/spring-cloud-commons/blob/master/spring-cloud-commons/src/main/java/org/springframework/cloud/client/loadbalancer/LoadBalancerClient.java">LoadBalancerClient</a> æ¥å£ï¼Œä½œä¸ºé€šç”¨çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ï¼Œæä¾›ä»æŒ‡å®šæœåŠ¡ä¸­é€‰æ‹©ä¸€ä¸ªå®ä¾‹ã€å¯¹æŒ‡å®šæœåŠ¡å‘èµ·è¯·æ±‚ç­‰ API æ–¹æ³•ã€‚è€Œæƒ³è¦é›†æˆåˆ° Spring Cloud ä½“ç³»çš„è´Ÿè½½å‡è¡¡çš„ç»„ä»¶ï¼Œéœ€è¦æä¾›å¯¹åº”çš„ LoadBalancerClient å®ç°ç±»ã€‚</p><p>ä¾‹å¦‚è¯´ï¼ŒSpring Cloud Netflix Ribbon æä¾›äº† <a href="https://github.com/spring-cloud/spring-cloud-netflix/blob/2.2.x/spring-cloud-netflix-ribbon/src/main/java/org/springframework/cloud/netflix/ribbon/RibbonLoadBalancerClient.java">RibbonLoadBalancerClient</a> å®ç°ã€‚</p><p>å¦‚æ­¤ï¼Œæ‰€æœ‰éœ€è¦ä½¿ç”¨åˆ°çš„åœ°æ–¹ï¼Œåªéœ€è¦è·å–åˆ° DiscoveryClient å®¢æˆ·ç«¯ï¼Œè€Œæ— éœ€å…³æ³¨å…·ä½“å®ç°ï¼Œä¿è¯å…¶é€šç”¨æ€§ã€‚ğŸ˜ˆ ä¸è¿‡è²Œä¼¼ Spring Cloud ä½“ç³»ä¸­ï¼Œæš‚æ—¶åªæœ‰ Ribbon ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç»„ä»¶ã€‚</p><p>å½“ç„¶ï¼ŒLoadBalancerClient çš„æœåŠ¡çš„å®ä¾‹åˆ—è¡¨ï¼Œæ˜¯æ¥è‡ª DiscoveryClient æä¾›çš„ã€‚</p></blockquote><p><code>/hello</code> æ¥å£ï¼Œç¤ºä¾‹æ¥å£ï¼Œå¯¹æœåŠ¡æä¾›è€…å‘èµ·ä¸€æ¬¡ HTTP è°ƒç”¨ã€‚</p><ul><li><code>&lt;1&gt;</code> å¤„ï¼Œè·å¾—æœåŠ¡ <code>demo-provider</code> çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™é‡Œæˆ‘ä»¬æä¾›äº†ä¸¤ç§æ–¹å¼çš„ä»£ç ï¼Œåˆ†åˆ«åŸºäº DiscoveryClient å’Œ LoadBalancerClientã€‚</li><li><code>&lt;2&gt;</code> å¤„ï¼Œé€šè¿‡è·å–åˆ°çš„æœåŠ¡å®ä¾‹ ServiceInstance å¯¹è±¡ï¼Œæ‹¼æ¥è¯·æ±‚çš„ç›®æ ‡ URLï¼Œä¹‹åä½¿ç”¨ RestTemplate å‘èµ· HTTP è°ƒç”¨ã€‚</li></ul><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><p>è®¿é—®ï¼š<a href="http://127.0.0.1:28080/hello?name=mengsu">http://127.0.0.1:28080/hello?name=mengsu</a> ï¼Œè¿”å›ç»“æœä¸º <code>&quot;consumer:provider:mengsu&quot;</code>ã€‚è¯´æ˜ï¼Œè°ƒç”¨è¿œç¨‹çš„<strong>æœåŠ¡æä¾›è€…</strong>æˆåŠŸã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>Nacos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Typoraå¿«æ·é”®</title>
    <link href="/2021/07/26/Typora%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <url>/2021/07/26/Typora%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="Typoraå¿«æ·é”®"><a href="#Typoraå¿«æ·é”®" class="headerlink" title="Typoraå¿«æ·é”®"></a>Typoraå¿«æ·é”®</h1><p>æœ€å¤§æ ‡é¢˜ï¼šcommand + 1 æˆ–è€…ï¼š#<br> å¤§æ ‡é¢˜ï¼šcommand + 2 æˆ–è€…ï¼š##<br> æ ‡å‡†æ ‡é¢˜ï¼šcommand + 3 æˆ–è€…ï¼š###<br> ä¸­æ ‡é¢˜ï¼šcommand + 4 æˆ–è€…ï¼š####<br> å°æ ‡é¢˜ï¼šcommand + 5 æˆ–è€…ï¼š#####<br> æ’å…¥è¡¨æ ¼ï¼šcommand + T<br> æ’å…¥ä»£ç ï¼šcommand + alt +c<br> æ’å…¥å›¾ç‰‡ï¼šcmd + ctrl + i<br> è¡Œé—´å…¬å¼ command + Alt + b<br> æ®µè½ï¼šcommand + 0<br> ç«–çº¿ ï¼š command + Alt +q<br> æ— éœ€åˆ—è¡¨ï¼šcommand+option+U<br> æœ‰åºåˆ—è¡¨ï¼ˆ1. 2.ï¼‰ ï¼šè¾“å…¥æ•°å­—+â€œ.â€ä¹‹åè¾“ å…¥ç©ºæ ¼ æˆ–è€…ï¼šcommand + Alt + o<br> é»‘ç‚¹æ ‡è®°ï¼šcommand + Alt + u<br> éš”ç¦»çº¿shift + command + -<br> è¶…é“¾æ¥ï¼šcommand + Alt + l<br> æ’å…¥é“¾æ¥ï¼šcommand +k<br> ä¸‹åˆ’çº¿ï¼šcommand +u<br> åŠ ç²—ï¼šcommand +b<br> æœç´¢ï¼šcommand +f<br> å¼•ç”¨ï¼šcommand+option+Q</p>]]></content>
    
    
    
    <tags>
      
      <tag>Typora</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nacoså®‰è£…è¿è¡Œ</title>
    <link href="/2021/07/26/nacos-install/"/>
    <url>/2021/07/26/nacos-install/</url>
    
    <content type="html"><![CDATA[<h2 id="å¿«é€Ÿå¼€å§‹"><a href="#å¿«é€Ÿå¼€å§‹" class="headerlink" title="å¿«é€Ÿå¼€å§‹"></a><a href="https://nacos.io/zh-cn/">å¿«é€Ÿå¼€å§‹</a></h2><h3 id="Dockerä¸‹è½½å®‰è£…"><a href="#Dockerä¸‹è½½å®‰è£…" class="headerlink" title="Dockerä¸‹è½½å®‰è£…"></a>Dockerä¸‹è½½å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull nacos/nacos-server<br></code></pre></td></tr></table></figure><h3 id="DockeræŸ¥çœ‹é•œåƒ"><a href="#DockeræŸ¥çœ‹é•œåƒ" class="headerlink" title="DockeræŸ¥çœ‹é•œåƒ"></a>DockeræŸ¥çœ‹é•œåƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker images<br></code></pre></td></tr></table></figure><h3 id="Dockerè¿è¡Œ"><a href="#Dockerè¿è¡Œ" class="headerlink" title="Dockerè¿è¡Œ"></a>Dockerè¿è¡Œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -d \<br>-e MODE=standalone \<br>-e SPRING_DATASOURCE_PLATFORM=mysql \<br>-e MYSQL_SERVICE_HOST=docker.for.mac.host.internal \<br>-e MYSQL_SERVICE_PORT=3306 \<br>-e MYSQL_SERVICE_USER=root \<br>-e MYSQL_SERVICE_PASSWORD=123456 \<br>-e MYSQL_SERVICE_DB_NAME=nacos_config \<br>-p 8848:8848 \<br>--restart=always \<br>nacos/nacos-server<br></code></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šè¿æ¥æ•°æ®åº“éœ€è¦å¯¼å…¥nacosè‡ªå·±çš„<a href="https://github.com/alibaba/nacos/edit/master/distribution/conf/nacos-mysql.sql">æ•°æ®åº“è„šæœ¬</a>ï¼Œè¯¥æ¨¡å¼ä¸ºå•æœºå¯åŠ¨</p><h3 id="DockeræŸ¥çœ‹è¿è¡ŒçŠ¶æ€"><a href="#DockeræŸ¥çœ‹è¿è¡ŒçŠ¶æ€" class="headerlink" title="DockeræŸ¥çœ‹è¿è¡ŒçŠ¶æ€"></a>DockeræŸ¥çœ‹è¿è¡ŒçŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker ps<br></code></pre></td></tr></table></figure><h3 id="è®¿é—®åœ°å€"><a href="#è®¿é—®åœ°å€" class="headerlink" title="è®¿é—®åœ°å€"></a>è®¿é—®åœ°å€</h3><p><a href="http://127.0.0.1:8848/">http://127.0.0.1:8848/</a>  ï¼Œé»˜è®¤è´¦å¯†éƒ½æ˜¯ï¼šnacos</p><h3 id="ç³»ç»Ÿæˆªå›¾"><a href="#ç³»ç»Ÿæˆªå›¾" class="headerlink" title="ç³»ç»Ÿæˆªå›¾"></a>ç³»ç»Ÿæˆªå›¾</h3><p><img src="/images/nacos/nacos-show.png" alt="ç‚¹å‡»"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Nacos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo</title>
    <link href="/2021/07/23/hello-world/"/>
    <url>/2021/07/23/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
